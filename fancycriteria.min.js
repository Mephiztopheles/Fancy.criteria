(function(){function c(f,h){for(var g in f){if(f.hasOwnProperty(g)){var e=h.call(f[g],g);if(e!==undefined){return e}}}return null}function a(f,e){return !e?f:Fancy.getKey(f,e)}function d(f){var g=a(f,this.key);var e=b.conditions[this.type];if(e&&typeof e==="function"){return e(g,this.value)}return false}function b(k){if(this===window){return new b(k)}function j(){var l=g.split("OR");console.log(l)}var h=[],f=[],e,i,g="";Object.defineProperty(this,"query",{get:function(){return g},set:function(l){g=l;j()}});this.or=function(n,m,o){if(arguments.length>3){o=[o];for(var l in arguments){if(arguments.hasOwnProperty(l)&&parseInt(l)>2){o.push(arguments[l])}}}if(g){g+=" "}g+=["OR",m,n,Fancy.type(o)==="array"?o.join(" and "):o].join(" ");h.push({type:n,key:m,value:o});return this};this.and=function(n,m,o){if(arguments.length>3){o=[o];for(var l in arguments){if(arguments.hasOwnProperty(l)&&parseInt(l)>2){o.push(arguments[l])}}}if(g){g+=" "}g+=["AND",m,n,Fancy.type(o)==="array"?o.join(" and "):o].join(" ");f.push({type:n,key:m,value:o});return this};if(Fancy.type(k)==="array"){this.offset=function(l){i=l;return this};this.max=function(l){e=l;return this}}this.list=function(l){var m=[];k.forEach(function(p,o){var n=true,q=h.length==0;c(f,function(){var r=d.call(this,p);if(!r){n=false;return false}});c(h,function(){var r=d.call(this,p);if(r){q=true;return false}});if(q&&n){if(l){m[o]=p}else{m.push(p)}}});return m};this.get=function(l){return c(k,function(n){var o=this,m=true,p=h.length==0;c(f,function(){var q=d.call(this,o);if(!q){m=false;return false}});c(h,function(){var q=d.call(this,o);if(q){p=true;return false}});if(p&&m){return l?{index:n.match(/^\d*$/)?parseInt(n):n,result:o}:o}})};return this}b.LIKE="like";b.EQUALS="eq";b.LOWER_THAN="lt";b.GREATER_THAN="gt";b.BETWEEN="bt";b.NOT="not";b.conditions={};b.conditions[b.LIKE]=function(e,f){if(typeof e!=="null"&&typeof e!=="undefined"){return e.toString().indexOf(f)>=0}else{return false}};b.conditions[b.EQUALS]=function(e,f){return e===f};b.conditions[b.LOWER_THAN]=function(e,f){return e<f};b.conditions[b.LOWER_THAN]=function(e,f){return e>f};b.conditions[b.BETWEEN]=function(e,f){return e>f[0]&&e<f[1]};b.conditions[b.NOT]=function(e,f){return e!==f};Fancy.criteria=b})();